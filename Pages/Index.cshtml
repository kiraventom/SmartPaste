@page
@model IndexModel

<div>
    <form id="form" method="post">
        <p>
        <textarea 
            id="textarea" 
            class="ta-autosize"
            asp-for="Text"></textarea>
        </p>

        Delete:
        @foreach (var kvp in IndexModel.ExpirationCaptions)
        {
            var id = $"{nameof(SmartPaste.Model.Expiration)}_{kvp.Value}";
            var name = kvp.Value;
            var exp = kvp.Key;

            <input type="radio" asp-for="Expiration" value="@exp" id="@id" />
            <label style="font-size: 12px" for="@id">@name</label>
        }

        <!-- Password toggle -->
        <div class="form-check">
            <input id="usePassword"
                   class="form-check-input"
                   type="checkbox"
                   asp-for="UsePassword" />
            <label class="form-check-label" for="usePassword">Lock with password</label>
        </div>

        <div class="mt-1">
            <input id="passwordInput"
                   type="password"
                   asp-for="Password"
                   disabled />
        </div>

        <p>
            <button id="saveBtn" type="submit">Save</button>
        </p>
    </form>

    <script>
        const textarea = document.getElementById('textarea');
        const form = document.getElementById('form');

        // Ctrl+Enter handle
        textarea.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && e.ctrlKey) {
                e.preventDefault();
                form.requestSubmit();
            }
        });

        // Password enable/disable
        const usePassword = document.getElementById('usePassword');
        const passwordInput = document.getElementById('passwordInput');

        function syncPasswordEnabled() {
            passwordInput.disabled = !usePassword.checked;
        }

        usePassword.addEventListener('change', syncPasswordEnabled);
        window.addEventListener('load', syncPasswordEnabled);
    </script>
</div>
